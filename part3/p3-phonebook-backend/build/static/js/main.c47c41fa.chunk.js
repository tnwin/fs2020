(this["webpackJsonpp2-phonebook"]=this["webpackJsonpp2-phonebook"]||[]).push([[0],{40:function(e,n,t){},41:function(e,n,t){"use strict";t.r(n);var r=t(0),c=t(1),o=t.n(c),a=t(16),i=t.n(a),u=(t(7),t(6)),s=t(3),d=t(4),l=t.n(d),j="/api/persons",b={create:function(e){return l.a.post(j,e).then((function(e){return e.data})).catch((function(e){return console.log("Error in POST request:",e.response.data),e.response.data}))},getAll:function(){return l.a.get(j).then((function(e){return e.data})).catch((function(e){return console.log("Error in GET all request \u30fc (connection to server):",e.response.data),e.response.data}))},update:function(e){return l.a.put("".concat(j,"/").concat(e.id),e).then((function(e){return e.data})).catch((function(e){return console.log("Error in PUT request:",e.response.data),e.response.data}))},remove:function(e){return l.a.delete("".concat(j,"/").concat(e)).then((function(e){return e.data})).catch((function(e){return console.log("Error in DELETE request:",e),e.response.data}))}},h=(t(40),function(e){var n=e.text,t=e.filter,c=e.handleInput;return Object(r.jsxs)("div",{children:[n," ",Object(r.jsx)("input",{value:t,onChange:c,placeholder:"Enter a name\uff0e\uff0e\uff0e"})]})}),f=function(e){var n=e.addPerson,t=e.name,c=e.number,o=e.handleNameInput,a=e.handleNumberInput;return Object(r.jsxs)("form",{onSubmit:n,children:[Object(r.jsx)("table",{children:Object(r.jsxs)("tbody",{children:[Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:"Name:"}),Object(r.jsx)("td",{children:Object(r.jsx)("input",{value:t,onChange:o,placeholder:"New name or update",required:!0,maxLength:"30"})})]}),Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:"Number:"}),Object(r.jsx)("td",{children:Object(r.jsx)("input",{value:c,onChange:a,placeholder:"+358 (0) 2941 911",pattern:"^[+]{0,1}[(\\)\\-\\s\\./0-9]*$",maxLength:"30"})})]})]})}),Object(r.jsx)("div",{children:Object(r.jsx)("button",{type:"submit",children:"add"})})]})},m=function(e){var n=e.persons,t=e.removePerson;return Object(r.jsx)(r.Fragment,{children:n.map((function(e){return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:e.name}),Object(r.jsx)("td",{children:e.number}),Object(r.jsx)("td",{children:Object(r.jsx)("button",{onClick:function(){return t(e.id,e.name)},children:"delete"})})]},e.name)}))})},p=function(e){var n=e.type,t=e.message;return Object(r.jsx)("div",{className:n,children:t})},O=function(){var e=Object(c.useState)([]),n=Object(s.a)(e,2),t=n[0],o=n[1],a=Object(c.useState)(""),i=Object(s.a)(a,2),d=i[0],l=i[1],j=Object(c.useState)(""),O=Object(s.a)(j,2),x=O[0],v=O[1],g=Object(c.useState)(""),y=Object(s.a)(g,2),w=y[0],E=y[1],N=Object(c.useState)(null),P=Object(s.a)(N,2),S=P[0],k=P[1],C=Object(c.useState)(null),I=Object(s.a)(C,2),T=I[0],q=I[1],A=Object(c.useState)(null),F=Object(s.a)(A,2),D=F[0],L=F[1],R=Object(c.useState)(!0),J=Object(s.a)(R,2),U=J[0],z=J[1];Object(c.useEffect)((function(){b.getAll().then((function(e){if("string"===typeof e&&e.includes("Proxy error"))return H("\ud83d\udeab Cannot connect to server.","error");e&&(o(e),z(!1))})).catch((function(e){return console.log("Error retrieving from server on initial run:",e)}))}),[]);var B=function(e){return t.find((function(n){return n.name===e.name}))},G=function(e,n){return window.confirm("\ud83d\udea8 ".concat(e.name," is already added to phonebook, replace the old number with this new one?"))?M(Object(u.a)(Object(u.a)({},e),{},{number:n})):null},M=function(e){return b.update(e).then((function(n){if("string"===typeof n&&n.includes("Proxy error"))return H("\ud83d\udeab Failed to update ".concat(e.name,". Cannot connect to server. Refreshing will prevent you from viewing the phonebook."),"error");n.error?H("\ud83d\udeab ".concat(n.error),"error"):"object"===typeof n&&(o((function(t){return t.map((function(t){return t.id===e.id?n:t}))})),H("\ud83c\udd99 Updated ".concat(n.name,"  with ").concat(n.number)),l(""),v(""))}))},W=function(e){return e.toLowerCase().trim()},$=t?t.filter((function(e){return-1!==W(e.name).indexOf("".concat(W(w)))})):[],H=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";clearTimeout(D),k(n),q(e),L(setTimeout((function(){k(null),q(null)}),5e3))};return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)("h2",{children:"Phonebook"}),Object(r.jsx)(p,{type:S,message:T}),Object(r.jsx)(h,{text:"Filter by",filter:w,handleInput:function(e){return E((function(){return e.target.value}))}}),Object(r.jsx)("h3",{children:"Add a new"}),Object(r.jsx)(f,{addPerson:function(e){e.preventDefault();var n={name:d.trim(),number:x.trim()},t=B(n);"undefined"!==typeof t?G(t,x):b.create(n).then((function(e){return"string"===typeof e&&e.includes("Proxy error")?H("\ud83d\udeab Failed to add ".concat(n.name," ").concat(n.number,". Cannot connect to server. Refreshing will prevent you from viewing the phonebook."),"error"):e.error?H("\ud83d\udeab ".concat(e.error),"error"):void("object"===typeof e&&(o((function(n){return n.concat(e)})),H("\ud83c\udd95 Added ".concat(n.name)),l(""),v("")))})).catch((function(e){console.log("Error from addPerson",e)}))},name:d,number:x,handleNameInput:function(e){return l(e.target.value)},handleNumberInput:function(e){return v(e.target.value)}}),Object(r.jsx)("h3",{children:"Numbers"}),U?Object(r.jsx)("em",{children:"\uff0e\uff0e\uff0eConnecting to server\uff0e\uff0e\uff0e"}):Object(r.jsxs)("table",{children:[Object(r.jsx)("thead",{children:t.length?Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{children:"Name"}),Object(r.jsx)("th",{children:"Number"}),Object(r.jsx)("th",{})]}):Object(r.jsx)("strong",{children:Object(r.jsx)("em",{children:"The phonebook is empty! What have you done??!!"})})}),Object(r.jsx)("tbody",{children:Object(r.jsx)(m,{persons:$,filter:w,removePerson:function(e,n){return window.confirm("\ud83d\udea8 Delete ".concat(n.replace(/\s+/g," ")," ?"))?b.remove(e).then((function(t){if("string"===typeof t&&t.includes("Proxy error"))return H("\ud83d\udeab Failed to delete ".concat(n,". Cannot connect to server. Refreshing will prevent you from viewing the phonebook."),"error");o((function(n){return n.filter((function(n){return n.id!==e}))})),H("\ud83d\udc4b Deleted ".concat(n))})).catch((function(t){console.log("Error deleting person",t),o((function(n){return n.filter((function(n){return n.id!==e}))})),H("\ud83d\udeab Information of ".concat(n," has already been removed from server"),"error")})):null},sanitizeString:W})})]})]})};i.a.render(Object(r.jsx)(o.a.StrictMode,{children:Object(r.jsx)(O,{})}),document.getElementById("root"))},7:function(e,n,t){}},[[41,1,2]]]);
//# sourceMappingURL=main.c47c41fa.chunk.js.map